---
title: "Summary report"
author: "Chris Beeley"
output: word_document
params:
  dates: NA
  inputs: NA
  data: NA
  options: NA
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE)

# where is this report for?

if(isTruthy(params$inputs$location_3)){
  
  location <- params$inputs$location_3
  
} else if(isTruthy(params$inputs$location_2)){
  
  location <- params$inputs$location_2
  
} else if(isTruthy(params$inputs$location_1)){
  
  location <- params$inputs$location_1
} else { # nothing selected
  
  location <- "the whole trust"
}


```

## Summary

This report summarises data from `r format(params$dates[1], "%b %d %Y")` to `r format(params$dates[2], "%b %d %Y")`, within `r location`.

```{r, results = "asis"}

if(params$options %in% "category_table"){
  
  cat("## Themes  \n")
  
  cat("### What could we do better?  \n")
  
  calculate_table(
    table_data = params$data, 
    count_column = "category",
    comment_type = "comment_1", 
    click_column = NULL
  ) %>% 
    pander::pandoc.table()
  
}

```

### What did we do well?

```{r, results = "asis"}

calculate_table(
  table_data = params$data, 
  count_column = "category",
  comment_type = "comment_2", 
  click_column = NULL
) %>% 
  pander::pandoc.table()

```

## SPC

```{r}

# only for unique individuals

fft_data <- params$data %>% 
  dplyr::distinct(pt_id, .keep_all = TRUE)

graph_data <- experiencesdashboard::split_data_spc(
  fft_data, variable = "fft", chunks = 15
)

experiencesdashboard::plot_fft_spc(graph_data)

```

